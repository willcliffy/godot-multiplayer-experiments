FROM golang:1.19 AS server-builder

WORKDIR /app

COPY server/ .
RUN mkdir -p /app/dist

RUN go install github.com/githubnemo/CompileDaemon@v1.4.0
RUN COOS=linux GOARCH=amd64 go build -ldflags="-w -s" -o /app/app /app/main.go

EXPOSE 8080
CMD /app/app
